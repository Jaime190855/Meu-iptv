<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV PREMIUM - Melhor Qualidade em Streaming</title>
    
    <!-- Tailwind CSS para Estiliza√ß√£o -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome para √çcones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * { font-family: 'Poppins', sans-serif; }
        body { scroll-behavior: smooth; overflow-x: hidden; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        @keyframes slide-up { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes message-appear { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-float { animation: float 4s ease-in-out infinite; }
        .animate-slide-up { animation: slide-up 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        .animate-message-appear { animation: message-appear 0.3s ease-out; }
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #e9d5ff; border-radius: 10px; }
    </style>

    <!-- Import Map para rodar React direto no Navegador -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom": "https://esm.sh/react-dom@18.2.0",
        "@google/generative-ai": "https://esm.sh/@google/generative-ai@0.1.0"
      }
    }
    </script>
</head>
<body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import ReactDOM from 'react-dom';
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // --- CONFIGURA√á√ïES DO SISTEMA ---
        // Se voc√™ tiver uma chave do Gemini, coloque aqui entre as aspas.
        const GEMINI_API_KEY = ""; 
        const TRIAL_API_URL = 'https://painel.vaptyplay.xyz/api/chatbot/XKjLMPR104/b8K1x6DvGN';
        const APP_DOWNLOAD_LINK = 'BAIXE O APLICATIVO: https://go.aftvnews.com/4695889';
        const ID_TO_REPLACE = 'xl1jz3V1Mj';

        // --- LOGICA DE SUPORTE (GEMINI) ---
        const SYSTEM_INSTRUCTION = `Voc√™ √© o assistente virtual oficial da IPTV PREMIUM.
Seu tom de voz deve ser amig√°vel, entusiasmado e profissional.

REGRAS:
1. NUNCA invente logins ou senhas.
2. Se pedirem teste, inicie a coleta: Nome, E-mail e WhatsApp.
3. Planos: Mensal (R$ 35) e Trimestral (R$ 90).`;

        const fetchAIResponse = async (userMessage, history) => {
            if (!GEMINI_API_KEY) return "Ol√°! Sou o assistente da IPTV PREMIUM. Como posso ajudar voc√™ hoje?";
            try {
                const genAI = new GoogleGenerativeAI(GEMINI_API_KEY);
                const model = genAI.getGenerativeModel({ model: "gemini-pro" });
                const chat = model.startChat({
                    history: history.map(m => ({
                        role: m.role === 'assistant' ? 'model' : 'user',
                        parts: [{ text: m.content }]
                    })),
                });
                const result = await chat.sendMessage(userMessage);
                return result.response.text();
            } catch (e) {
                return "Desculpe, tive um problema t√©cnico. Fale com nosso suporte via WhatsApp!";
            }
        };

        // --- COMPONENTE DO CHATBOT ---
        const Chatbot = ({ isOpen, onClose, initialTrialMode }) => {
            const [messages, setMessages] = useState([
                { role: 'assistant', content: 'üëã Ol√°! Sou o assistente da IPTV PREMIUM. Como posso tornar sua experi√™ncia de TV incr√≠vel hoje?' }
            ]);
            const [input, setInput] = useState('');
            const [loading, setLoading] = useState(false);
            const [step, setStep] = useState(initialTrialMode ? 'NAME' : 'NORMAL');
            const [userData, setUserData] = useState({});
            const endRef = useRef(null);

            useEffect(() => { endRef.current?.scrollIntoView({ behavior: 'smooth' }); }, [messages]);

            const addMsg = (role, content, isTrial = false) => {
                setMessages(prev => [...prev, { role, content, isTrialData: isTrial }]);
            };

            const handleSend = async () => {
                if (!input.trim() || loading) return;
                const text = input.trim();
                addMsg('user', text);
                setInput('');

                if (step === 'NAME') {
                    setUserData({ name: text });
                    setStep('EMAIL');
                    addMsg('assistant', `Prazer, ${text}! Agora, qual o seu e-mail?`);
                } else if (step === 'EMAIL') {
                    setUserData(p => ({ ...p, email: text }));
                    setStep('PHONE');
                    addMsg('assistant', "√ìtimo! Por √∫ltimo, qual o seu WhatsApp com DDD?");
                } else if (step === 'PHONE') {
                    setLoading(true);
                    addMsg('assistant', "üîÑ Gerando seu teste... Aguarde.");
                    try {
                        const res = await fetch(TRIAL_API_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ ...userData, phone: text, message: "Via Web" })
                        });
                        const data = await res.json();
                        let responseText = data.response || data.message || JSON.stringify(data);
                        // Substitui√ß√£o de link/limpeza
                        responseText = responseText.replace(new RegExp(ID_TO_REPLACE, 'g'), APP_DOWNLOAD_LINK);
                        addMsg('assistant', responseText, true);
                        setStep('NORMAL');
                    } catch (e) {
                        addMsg('assistant', "Erro ao gerar teste autom√°tico. Chame no WhatsApp!");
                    } finally { setLoading(false); }
                } else {
                    setLoading(true);
                    const aiRes = await fetchAIResponse(text, messages);
                    addMsg('assistant', aiRes);
                    setLoading(false);
                }
            };

            if (!isOpen) return null;

            return (
                <div className="fixed bottom-24 right-4 md:right-8 w-[400px] max-w-[calc(100vw-32px)] h-[600px] bg-white rounded-3xl shadow-2xl z-[1000] flex flex-col overflow-hidden animate-slide-up border border-purple-100">
                    <div className="gradient-bg p-5 text-white flex justify-between items-center">
                        <div className="flex items-center gap-3">
                            <div className="w-10 h-10 bg-white/20 rounded-xl flex items-center justify-center backdrop-blur-md">
                                <i className="fas fa-robot"></i>
                            </div>
                            <span className="font-bold">IPTV Suporte</span>
                        </div>
                        <button onClick={onClose} className="opacity-70 hover:opacity-100"><i className="fas fa-times"></i></button>
                    </div>
                    <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50 scrollbar-thin">
                        {messages.map((m, i) => (
                            <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                <div className={`max-w-[85%] p-3 rounded-2xl text-sm ${
                                    m.role === 'user' ? 'bg-purple-600 text-white rounded-br-none' : 'bg-white text-gray-800 border border-gray-100 rounded-bl-none'
                                } ${m.isTrialData ? 'font-mono text-[10px] bg-purple-50 border-purple-200 border-2' : ''}`}>
                                    {m.content}
                                    {m.isTrialData && (
                                        <button onClick={() => { navigator.clipboard.writeText(m.content); alert('Copiado!'); }} className="w-full mt-2 bg-purple-600 text-white py-2 rounded-lg font-bold text-[9px] uppercase">Copiar Acesso</button>
                                    )}
                                </div>
                            </div>
                        ))}
                        <div ref={endRef} />
                    </div>
                    <div className="p-4 border-t flex gap-2">
                        <input className="flex-1 bg-gray-100 rounded-xl px-4 py-2 outline-none text-sm" placeholder="Digite aqui..." value={input} onChange={e => setInput(e.target.value)} onKeyPress={e => e.key === 'Enter' && handleSend()} />
                        <button onClick={handleSend} className="w-10 h-10 gradient-bg text-white rounded-xl"><i className="fas fa-paper-plane"></i></button>
                    </div>
                </div>
            );
        };

        // --- P√ÅGINA PRINCIPAL ---
        const App = () => {
            const [chatOpen, setChatOpen] = useState(false);
            const [trialMode, setTrialMode] = useState(false);

            const openTrial = () => { setTrialMode(true); setChatOpen(true); };

            return (
                <div className="min-h-screen">
                    {/* Navega√ß√£o */}
                    <nav className="gradient-bg p-4 sticky top-0 z-50 shadow-lg text-white">
                        <div className="container mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-2 text-xl font-black uppercase tracking-tighter">
                                <i className="fas fa-play-circle text-yellow-300"></i> IPTV <span className="text-yellow-300">PREMIUM</span>
                            </div>
                            <div className="hidden md:flex gap-6 text-sm font-bold">
                                <a href="#canais" className="hover:text-yellow-300">CANAIS</a>
                                <a href="#planos" className="hover:text-yellow-300">PLANOS</a>
                            </div>
                            <button onClick={openTrial} className="bg-yellow-400 text-purple-900 px-5 py-2 rounded-full font-bold text-xs">TESTE GR√ÅTIS</button>
                        </div>
                    </nav>

                    {/* Hero */}
                    <header className="gradient-bg text-white pt-20 pb-32 relative overflow-hidden">
                        <div className="container mx-auto px-4 text-center">
                            <h1 className="text-5xl md:text-7xl font-black mb-6 leading-tight">Sua TV sem <br/><span className="text-yellow-300">travamentos.</span></h1>
                            <p className="text-lg opacity-90 mb-10 max-w-2xl mx-auto">Acesso premium a todos os canais, filmes e s√©ries em 4K. Estabilidade garantida com tecnologia P2P.</p>
                            <button onClick={openTrial} className="bg-white text-purple-600 px-10 py-5 rounded-full font-black text-xl shadow-2xl hover:scale-105 transition">SOLICITAR TESTE GR√ÅTIS</button>
                        </div>
                        <div className="flex justify-center mt-16 px-4">
                            <img src="https://images.unsplash.com/photo-1593784991095-a205069470b6?w=800&q=80" className="rounded-3xl shadow-2xl border-4 border-white/10 animate-float max-w-full md:max-w-3xl" />
                        </div>
                    </header>

                    {/* Planos */}
                    <section id="planos" className="py-24 bg-gray-100">
                        <div className="container mx-auto px-4">
                            <h2 className="text-4xl font-black text-center mb-16 gradient-text">Nossos Planos</h2>
                            <div className="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                                <div className="bg-white p-10 rounded-[40px] shadow-xl text-center">
                                    <h3 className="text-xl font-bold mb-4 uppercase">Mensal</h3>
                                    <div className="text-5xl font-black mb-8">R$ 35<span className="text-sm opacity-50">,00</span></div>
                                    <ul className="text-left space-y-3 mb-10 text-gray-600">
                                        <li><i className="fas fa-check text-green-500 mr-2"></i> +10.000 Canais HD/4K</li>
                                        <li><i className="fas fa-check text-green-500 mr-2"></i> Futebol e Esportes VIP</li>
                                        <li><i className="fas fa-check text-green-500 mr-2"></i> 1 Tela Simult√¢nea</li>
                                    </ul>
                                    <a href="https://wa.me/5551985502897" className="block w-full py-4 rounded-2xl bg-gray-100 font-bold hover:bg-purple-600 hover:text-white transition">ASSINAR</a>
                                </div>
                                <div className="bg-white p-10 rounded-[40px] shadow-2xl border-4 border-purple-600 scale-105 relative text-center">
                                    <div className="absolute top-5 right-[-20px] bg-yellow-400 px-8 py-1 rotate-45 text-[10px] font-black">POPULAR</div>
                                    <h3 className="text-xl font-bold mb-4 uppercase text-purple-600">Trimestral</h3>
                                    <div className="text-5xl font-black mb-8">R$ 90<span className="text-sm opacity-50">,00</span></div>
                                    <ul className="text-left space-y-3 mb-10 font-bold">
                                        <li><i className="fas fa-check text-purple-600 mr-2"></i> Tudo do Mensal</li>
                                        <li><i className="fas fa-check text-purple-600 mr-2"></i> Suporte Priorit√°rio</li>
                                        <li><i className="fas fa-check text-purple-600 mr-2"></i> 1 Tela Simult√¢nea</li>
                                    </ul>
                                    <a href="https://wa.me/5551985502897" className="block w-full py-4 rounded-2xl gradient-bg text-white font-black shadow-lg">CONTRATAR AGORA</a>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Footer */}
                    <footer className="bg-gray-900 text-white py-12 text-center text-xs opacity-50 uppercase tracking-widest font-bold">
                        &copy; 2024 IPTV PREMIUM - TODOS OS DIREITOS RESERVADOS
                    </footer>

                    {/* Bot√µes Flutuantes */}
                    <div className="fixed bottom-6 right-6 flex flex-col gap-4 z-50">
                        <a href="https://wa.me/5551985502897" target="_blank" className="w-14 h-14 bg-green-500 text-white rounded-full flex items-center justify-center text-3xl shadow-2xl hover:scale-110 transition animate-bounce"><i className="fab fa-whatsapp"></i></a>
                        <button onClick={() => { setTrialMode(false); setChatOpen(true); }} className="w-14 h-14 gradient-bg text-white rounded-full flex items-center justify-center text-2xl shadow-2xl hover:scale-110 transition"><i className="fas fa-comments"></i></button>
                    </div>

                    <Chatbot isOpen={chatOpen} onClose={() => setChatOpen(false)} initialTrialMode={trialMode} />
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>

