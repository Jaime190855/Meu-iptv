<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV PREMIUM - Melhor Qualidade em Streaming</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        * { font-family: 'Poppins', sans-serif; }
        body { scroll-behavior: smooth; overflow-x: hidden; }
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-30px); }
        }
        @keyframes slide-up { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes message-appear { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-slide-up { animation: slide-up 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
        .animate-message-appear { animation: message-appear 0.3s ease-out; }
        .scrollbar-thin::-webkit-scrollbar { width: 4px; }
        .scrollbar-thin::-webkit-scrollbar-thumb { background: #e9d5ff; border-radius: 10px; }
    </style>

    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@19.0.0",
        "react-dom/client": "https://esm.sh/react-dom@19.0.0/client",
        "@google/generative-ai": "https://esm.sh/@google/generative-ai@0.21.0"
      }
    }
    </script>
</head>
<body class="bg-gray-50 text-gray-900">
    <div id="root"></div>

    <script type="module">
        import React, { useState, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { GoogleGenerativeAI } from "@google/generative-ai";

        // --- CONFIGURA√á√ïES ---
        const API_KEY = ""; // COLOQUE A SUA CHAVE GEMINI AQUI PARA O GITHUB PAGES
        const TRIAL_API_URL = 'https://painel.vaptyplay.xyz/api/chatbot/XKjLMPR104/b8K1x6DvGN';
        const APP_DOWNLOAD_LINK = 'BAIXE O APLICATIVO: https://go.aftvnews.com/4695889';
        const ID_TO_REPLACE = 'xl1jz3V1Mj';

        // --- ENUMS (types.ts) ---
        const ChatMode = {
            NORMAL: 'NORMAL',
            COLLECTING_NAME: 'COLLECTING_NAME',
            COLLECTING_EMAIL: 'COLLECTING_EMAIL',
            COLLECTING_PHONE: 'COLLECTING_PHONE',
        };

        // --- IA SERVICE (geminiService.ts) ---
        const SYSTEM_INSTRUCTION = `Voc√™ √© o assistente virtual oficial da IPTV PREMIUM.
Seu tom de voz deve ser amig√°vel, entusiasmado e profissional.

REGRAS CR√çTICAS:
1. PROIBIDO: Inventar usu√°rios, senhas ou links de listas.
2. OBRIGAT√ìRIO: Quando pedirem teste, diga que vai coletar os dados para o sistema.
3. Pe√ßa: Nome Completo, E-mail e WhatsApp (com DDD).
4. Informe que os dados aparecer√£o aqui em instantes.

Sobre a IPTV:
- Tecnologia P2P anti-travamento. Canais 4K/Full HD.
- Planos: Mensal (R$ 35) e Trimestral (R$ 90). 1 tela por plano.`;

        const getChatResponse = async (message, history) => {
            try {
                if (!API_KEY) return "Ol√°! Sou o assistente IPTV. Como posso ajudar com a sua televis√£o hoje? (Nota: Configure a API Key para IA avan√ßada)";
                
                const genAI = new GoogleGenerativeAI(API_KEY);
                const model = genAI.getGenerativeModel({ model: "gemini-1.5-flash" });
                
                const chatHistory = history.map(m => ({
                    role: m.role === 'assistant' ? 'model' : 'user',
                    parts: [{ text: m.content }]
                }));

                const chat = model.startChat({
                    history: chatHistory,
                    generationConfig: { maxOutputTokens: 500, temperature: 0.3 },
                });

                const result = await chat.sendMessage(`${SYSTEM_INSTRUCTION}\n\nUsu√°rio: ${message}`);
                return result.response.text();
            } catch (error) {
                console.error("Erro Gemini:", error);
                return "Desculpe, tive um problema t√©cnico. Por favor, tente novamente ou fale com nosso suporte via WhatsApp.";
            }
        };

        // --- COMPONENTE CHATBOT (Chatbot.tsx) ---
        const Chatbot = ({ isOpen, onClose, initialTrialMode = false }) => {
            const [messages, setMessages] = useState([
                { role: 'assistant', content: 'üëã Ol√°! Sou o assistente da IPTV PREMIUM. Como posso tornar sua experi√™ncia de TV incr√≠vel hoje?' }
            ]);
            const [inputValue, setInputValue] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [mode, setMode] = useState(ChatMode.NORMAL);
            const [trialData, setTrialData] = useState({});
            const messagesEndRef = useRef(null);

            useEffect(() => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            }, [messages, isLoading]);

            useEffect(() => {
                if (initialTrialMode && mode === ChatMode.NORMAL && isOpen) startTrialFlow();
            }, [initialTrialMode, isOpen]);

            const startTrialFlow = () => {
                if (localStorage.getItem('iptv_trial_final_v23')) {
                    addAssistantMessage("Notei que voc√™ j√° solicitou um teste recentemente. Para novos acessos, fale com nosso suporte!");
                    return;
                }
                setMode(ChatMode.COLLECTING_NAME);
                addAssistantMessage("Maravilha! Vamos gerar seu teste gratuito agora mesmo. üöÄ\n\nQual o seu **Nome Completo**?");
            };

            const cleanTrialContent = (content) => {
                let lines = content.split('\n');
                const processedLines = lines.filter(line => {
                    const trimmed = line.trim();
                    const lower = line.toLowerCase();
                    if (trimmed === '----------' || trimmed === '__________' || trimmed === '-------') return false;
                    if (trimmed.includes(ID_TO_REPLACE)) return true;
                    if (lower.includes('checkout') || lower.includes('pagar')) return false;
                    return true;
                }).map(line => line.includes(ID_TO_REPLACE) ? APP_DOWNLOAD_LINK : line);
                return processedLines.join('\n').replace(/\n\s*\n\n/g, '\n\n').trim();
            };

            const addAssistantMessage = (content, isTrialData = false) => {
                let safeContent = typeof content === 'string' ? content : (content.response || content.message || JSON.stringify(content));
                if (isTrialData) safeContent = cleanTrialContent(safeContent);
                setMessages(prev => [...prev, { role: 'assistant', content: safeContent, isTrialData }]);
            };

            const handleTrialFlow = async (text) => {
                if (mode === ChatMode.COLLECTING_NAME) {
                    setTrialData(prev => ({ ...prev, name: text }));
                    setMode(ChatMode.COLLECTING_EMAIL);
                    addAssistantMessage(`Prazer, ${text}! Agora, por favor, informe seu **e-mail**.`);
                    return;
                }
                if (mode === ChatMode.COLLECTING_EMAIL) {
                    if (!text.includes('@')) return addAssistantMessage("E-mail inv√°lido. Digite novamente.");
                    setTrialData(prev => ({ ...prev, email: text }));
                    setMode(ChatMode.COLLECTING_PHONE);
                    addAssistantMessage("Perfeito! Por √∫ltimo, qual o seu **WhatsApp com DDD**?");
                    return;
                }
                if (mode === ChatMode.COLLECTING_PHONE) {
                    const finalData = { ...trialData, phone: text };
                    setMode(ChatMode.NORMAL);
                    setIsLoading(true);
                    addAssistantMessage("üîÑ **CONECTANDO AO SERVIDOR...**\nGerando seus dados de acesso exclusivos.");
                    try {
                        const response = await fetch(TRIAL_API_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ ...finalData, message: "Solicita√ß√£o via Chatbot Web v23" })
                        });
                        const json = await response.json();
                        if (response.ok) {
                            localStorage.setItem('iptv_trial_final_v23', 'true');
                            addAssistantMessage(json.response || JSON.stringify(json), true);
                            addAssistantMessage("üéâ **ACESSO GERADO!**\n\nüì• **LINK PARA INSTALA√á√ÉO:** https://go.aftvnews.com/4695889");
                        } else {
                            addAssistantMessage("Sistema em manuten√ß√£o. Pe√ßa via WhatsApp!");
                        }
                    } catch (e) {
                        addAssistantMessage("Erro de conex√£o. Clique no bot√£o do WhatsApp!");
                    } finally { setIsLoading(false); }
                }
            };

            const handleSend = async () => {
                if (!inputValue.trim() || isLoading) return;
                const userText = inputValue.trim();
                setMessages(prev => [...prev, { role: 'user', content: userText }]);
                setInputValue('');

                if (mode !== ChatMode.NORMAL) {
                    await handleTrialFlow(userText);
                    return;
                }

                setIsLoading(true);
                const aiResponse = await getChatResponse(userText, messages);
                addAssistantMessage(aiResponse);
                setIsLoading(false);

                const lower = userText.toLowerCase();
                if (['teste', 'testar', 'gratis', 'libera'].some(t => lower.includes(t)) && !localStorage.getItem('iptv_trial_final_v23')) {
                    setTimeout(() => addAssistantMessage("Quer que eu gere seus dados de acesso agora?"), 1000);
                }
                if ((lower === 'sim' || lower.includes('quero')) && mode === ChatMode.NORMAL) startTrialFlow();
            };

            if (!isOpen) return null;

            return (
                <div className="fixed bottom-24 right-4 md:right-8 w-[440px] max-w-[calc(100vw-32px)] h-[680px] bg-white rounded-3xl shadow-2xl flex flex-col z-[1000] overflow-hidden animate-slide-up border border-purple-100">
                    <div className="gradient-bg text-white p-6 flex justify-between items-center shadow-xl">
                        <div className="flex items-center gap-4">
                            <div className="w-12 h-12 bg-white/20 rounded-2xl flex items-center justify-center backdrop-blur-sm">
                                <i className="fas fa-robot text-2xl"></i>
                            </div>
                            <div>
                                <h3 className="font-extrabold text-xl leading-tight">IPTV PREMIUM</h3>
                                <p className="text-xs text-green-300 font-bold uppercase tracking-widest flex items-center gap-1">
                                    <span className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></span> Online
                                </p>
                            </div>
                        </div>
                        <button onClick={onClose} className="hover:bg-white/20 p-2.5 rounded-xl transition bg-black/10"><i className="fas fa-times"></i></button>
                    </div>

                    <div className="flex-1 overflow-y-auto p-5 bg-slate-50 space-y-5 scrollbar-thin">
                        {messages.map((m, i) => (
                            <div key={i} className={`flex ${m.role === 'user' ? 'justify-end' : 'justify-start'} animate-message-appear`}>
                                <div className={`max-w-[95%] p-4 rounded-2xl text-sm shadow-sm ${
                                    m.role === 'user' ? 'bg-purple-600 text-white rounded-br-none' : 'bg-white text-gray-800 border border-purple-50 rounded-bl-none'
                                } ${m.isTrialData ? 'border-2 border-purple-600 bg-purple-50 font-mono text-[10px] shadow-xl' : ''}`}>
                                    {m.content}
                                    {m.isTrialData && (
                                        <button 
                                            onClick={() => { navigator.clipboard.writeText(m.content); alert('Copiado!'); }}
                                            className="w-full mt-4 bg-purple-600 text-white py-3 rounded-xl font-black uppercase text-[10px] shadow-lg"
                                        >
                                            <i className="fas fa-copy mr-2"></i> Copiar Dados
                                        </button>
                                    )}
                                </div>
                            </div>
                        ))}
                        {isLoading && <div className="p-4 bg-white rounded-2xl shadow-sm border border-purple-50 flex gap-2 w-20 justify-center animate-pulse">...</div>}
                        <div ref={messagesEndRef} />
                    </div>

                    <div className="p-5 bg-white border-t border-purple-50 flex gap-3">
                        <input
                            className="flex-1 bg-slate-100 rounded-2xl px-6 py-4 text-sm focus:ring-2 focus:ring-purple-400 outline-none"
                            placeholder="Digite aqui sua d√∫vida..."
                            value={inputValue}
                            onChange={(e) => setInputValue(e.target.value)}
                            onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                        />
                        <button onClick={handleSend} className="w-14 h-14 rounded-2xl gradient-bg text-white flex items-center justify-center hover:scale-105 transition shadow-xl shadow-purple-200">
                            <i className="fas fa-paper-plane"></i>
                        </button>
                    </div>
                </div>
            );
        };

        // --- COMPONENTE LANDING PAGE (App.tsx) ---
        const App = () => {
            const [isChatOpen, setIsChatOpen] = useState(false);
            const [trialMode, setTrialMode] = useState(false);

            const openChat = (trial = false) => { setTrialMode(trial); setIsChatOpen(true); };

            const channelGroups = [
                { title: 'Canais Brasileiros', icon: 'üáßüá∑', channels: [{ name: 'Globo', color: 'text-purple-600' }, { name: 'Record', color: 'text-blue-600' }, { name: 'SBT', color: 'text-red-600' }, { name: 'Band', color: 'text-orange-500' }] },
                { title: 'Esportes', icon: '‚öΩ', channels: [{ name: 'ESPN', color: 'text-red-600' }, { name: 'SporTV', color: 'text-green-600' }, { name: 'Premiere', color: 'text-purple-600' }, { name: 'DAZN', color: 'text-yellow-500' }] },
                { title: 'Filmes e S√©ries', icon: 'üé¨', channels: [{ name: 'HBO', color: 'text-red-700' }, { name: 'Telecine', color: 'text-purple-700' }, { name: 'Warner', color: 'text-blue-700' }, { name: 'Paramount', color: 'text-orange-400' }] }
            ];

            return (
                <div className="min-h-screen">
                    {/* Header */}
                    <header className="gradient-bg text-white py-5 sticky top-0 z-50 shadow-xl">
                        <div className="container mx-auto px-4 flex justify-between items-center">
                            <div className="flex items-center gap-3 cursor-pointer" onClick={() => window.scrollTo(0,0)}>
                                <i className="fas fa-play-circle text-4xl text-yellow-300"></i>
                                <h1 className="text-2xl font-black uppercase">IPTV <span className="text-yellow-300">PREMIUM</span></h1>
                            </div>
                            <div className="flex gap-4">
                                <button onClick={() => openChat(true)} className="bg-yellow-400 text-purple-900 px-6 py-2 rounded-full font-bold hover:bg-yellow-300 hidden sm:block text-xs">TESTE GR√ÅTIS</button>
                                <a href="https://wa.me/5551985502897" className="bg-white/20 border border-white/30 px-6 py-2 rounded-full font-bold text-xs">SUPORTE</a>
                            </div>
                        </div>
                    </header>

                    {/* Hero */}
                    <section id="home" className="gradient-bg text-white pt-24 pb-32 text-center relative overflow-hidden">
                        <div className="container mx-auto px-4 relative z-10">
                            <span className="bg-yellow-400 text-purple-900 px-4 py-1.5 rounded-full text-[10px] font-black uppercase mb-6 inline-block animate-bounce">üî• P2P CDN H√çBRIDA</span>
                            <h2 className="text-5xl md:text-7xl font-extrabold mb-8 leading-[1.1]">A TV do futuro, <br/><span className="text-yellow-300">hoje na sua casa.</span></h2>
                            <p className="text-xl mb-10 opacity-90 max-w-2xl mx-auto">Qualidade 4K sem travamentos para todos os canais, filmes e s√©ries que voc√™ ama.</p>
                            <div className="flex flex-col sm:flex-row gap-4 justify-center">
                                <button onClick={() => openChat(true)} className="bg-white text-purple-600 px-10 py-5 rounded-full font-black text-lg shadow-2xl hover:scale-105 transition">TESTE GR√ÅTIS</button>
                                <a href="#planos" className="bg-purple-800/40 border border-white/20 px-10 py-5 rounded-full font-black text-lg hover:bg-purple-800/60 transition">VER PLANOS</a>
                            </div>
                        </div>
                    </section>

                    {/* Canais */}
                    <section id="canais" className="py-24 bg-white">
                        <div className="container mx-auto px-4">
                            <h2 className="text-4xl font-black mb-16 text-center gradient-text uppercase tracking-tighter">Grade de Canais</h2>
                            <div className="space-y-20">
                                {channelGroups.map((group, idx) => (
                                    <div key={idx} className="space-y-8">
                                        <h3 className="text-xl font-black text-center uppercase tracking-widest">{group.icon} {group.title}</h3>
                                        <div className="grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-4 gap-6">
                                            {group.channels.map((ch, cidx) => (
                                                <div key={cidx} className="bg-slate-50 p-8 rounded-3xl text-center border border-gray-100 hover:shadow-xl transition-all h-24 flex items-center justify-center">
                                                    <span className={`font-black text-sm uppercase ${ch.color}`}>{ch.name}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* Planos */}
                    <section id="planos" className="py-24 bg-gray-100">
                        <div className="container mx-auto px-4 text-center">
                            <h2 className="text-4xl font-black mb-16">Planos Simples</h2>
                            <div className="grid md:grid-cols-2 gap-10 max-w-4xl mx-auto">
                                <div className="bg-white p-12 rounded-[40px] shadow-xl border border-gray-100">
                                    <h3 className="text-xl font-black mb-4 uppercase">Mensal</h3>
                                    <div className="text-6xl font-black mb-10">R$ 35<span className="text-sm opacity-50">,00</span></div>
                                    <ul className="text-left space-y-4 mb-12 text-gray-600 font-medium">
                                        <li><i className="fas fa-check-circle text-green-500 mr-2"></i> +10.000 Canais HD/4K</li>
                                        <li><i className="fas fa-check-circle text-green-500 mr-2"></i> Filmes & S√©ries VOD</li>
                                        <li><i className="fas fa-check-circle text-green-500 mr-2"></i> 1 Tela Simult√¢nea</li>
                                    </ul>
                                    <a href="https://wa.me/5551985502897" className="block w-full py-5 rounded-3xl bg-slate-100 font-black hover:bg-purple-600 hover:text-white transition shadow-lg">ASSINAR</a>
                                </div>
                                <div className="bg-white p-12 rounded-[40px] shadow-2xl border-4 border-purple-600 scale-105 relative">
                                    <div className="absolute top-6 right-[-35px] bg-yellow-400 px-12 py-1 rotate-45 font-black text-[10px] uppercase">Econ√¥mico</div>
                                    <h3 className="text-xl font-black mb-4 uppercase text-purple-600">Trimestral</h3>
                                    <div className="text-6xl font-black mb-4">R$ 90<span className="text-sm opacity-50">,00</span></div>
                                    <p className="text-green-600 font-bold text-xs mb-10 italic">Apenas R$ 30,00 por m√™s!</p>
                                    <ul className="text-left space-y-4 mb-12 font-bold">
                                        <li><i className="fas fa-check-circle text-purple-600 mr-2"></i> Tudo do Mensal</li>
                                        <li><i className="fas fa-check-circle text-purple-600 mr-2"></i> Grade 4K Premium</li>
                                        <li><i className="fas fa-check-circle text-purple-600 mr-2"></i> Suporte Priorit√°rio</li>
                                    </ul>
                                    <a href="https://wa.me/5551985502897" className="block w-full py-5 rounded-3xl gradient-bg text-white font-black shadow-xl">ASSINAR AGORA</a>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Footer */}
                    <footer className="bg-gray-900 text-white py-12 text-center">
                        <div className="flex items-center justify-center gap-3 mb-6">
                            <i className="fas fa-play-circle text-4xl text-yellow-300"></i>
                            <h1 className="text-2xl font-black uppercase">IPTV <span className="text-yellow-300">PREMIUM</span></h1>
                        </div>
                        <p className="text-gray-500 text-[10px] font-bold uppercase tracking-widest">&copy; 2024 IPTV PREMIUM - TODOS OS DIREITOS RESERVADOS.</p>
                    </footer>

                    {/* Bot√µes Flutuantes */}
                    <div className="fixed bottom-6 right-6 flex flex-col gap-4 z-50">
                        <a href="https://wa.me/5551985502897" className="w-16 h-16 bg-green-500 text-white rounded-full flex items-center justify-center text-4xl shadow-2xl hover:scale-110 transition animate-bounce"><i className="fab fa-whatsapp"></i></a>
                        <button onClick={() => openChat()} className="w-16 h-16 gradient-bg text-white rounded-full flex items-center justify-center text-3xl shadow-2xl hover:scale-110 transition"><i className="fas fa-comments"></i></button>
                    </div>

                    <Chatbot isOpen={isChatOpen} onClose={() => setIsChatOpen(false)} initialTrialMode={trialMode} />
                </div>
            );
        };

        const root = createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

